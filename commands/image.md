# Generate Images from Prompts using Seedream API

## ä»»åŠ¡ç›®æ ‡
ä»é¡¹ç›®æ–‡ä»¶å¤¹ä¸­è¯»å– `script_output.json`ï¼Œä½¿ç”¨ Seedream API æ‰¹é‡ç”Ÿæˆé«˜è´¨é‡å›¾åƒæ–‡ä»¶ã€‚

## âš ï¸ æ ¸å¿ƒè§„åˆ™ï¼šæ‰¹æ¬¡å¤§å°é™åˆ¶

**æ¯æ¬¡è°ƒç”¨ `prompt_to_image_batch` æœ€å¤šå¤„ç† 10 ä¸ªæç¤ºè¯**

è¿™æ˜¯ç¡¬æ€§é™åˆ¶ï¼ŒåŸå› ï¼š
1. é¿å…å•æ¬¡ API è°ƒç”¨è¶…æ—¶
2. ä¾¿äºæ–­ç‚¹ç»­ä¼ 
3. å‡å°‘å•æ¬¡å¤±è´¥çš„å½±å“èŒƒå›´

**æ‰¹æ¬¡å¤„ç†æµç¨‹**ï¼š
- å¦‚æœæç¤ºè¯æ€»æ•° â‰¤ 10ï¼šä¸€æ¬¡å¤„ç†å®Œæˆ
- å¦‚æœæç¤ºè¯æ€»æ•° > 10ï¼šåˆ†å¤šæ‰¹å¤„ç†ï¼Œæ¯æ‰¹ 10 ä¸ªï¼ˆæœ€åä¸€æ‰¹å¯èƒ½ä¸è¶³ 10 ä¸ªï¼‰

---

## é‡è¦ï¼šå¤šå›¾åƒæ”¯æŒ

**Seedream API å¯èƒ½ä¸ºå•ä¸ª prompt ç”Ÿæˆå¤šå¼ å›¾åƒ**ã€‚å½“ `sequential_image_generation` è®¾ç½®ä¸º `'on'` æˆ– `'auto'` æ—¶ï¼Œæ¨¡å‹ä¼šæ ¹æ® prompt å†…å®¹æ¨æ–­æ˜¯å¦éœ€è¦ç”Ÿæˆåºåˆ—å›¾åƒï¼ˆå¦‚æ•…äº‹ã€åœºæ™¯å˜åŒ–ç­‰ï¼‰ã€‚

**å…³é”®**ï¼šè°ƒç”¨ MCP å·¥å…·åï¼Œå¿…é¡»æ£€æŸ¥è¿”å›ç»“æœä¸­çš„ `image_count` å­—æ®µï¼š
- `image_count = 1`: å•å¼ å›¾åƒï¼Œä½¿ç”¨ `output_file` å­—æ®µ
- `image_count > 1`: å¤šå¼ å›¾åƒï¼Œä½¿ç”¨ `images` æ•°ç»„è·å–æ‰€æœ‰å›¾åƒè·¯å¾„

## è¾“å…¥è¦æ±‚
- **å¿…éœ€å‚æ•°**ï¼šé¡¹ç›®æ–‡ä»¶å¤¹è·¯å¾„ï¼ˆåŒ…å« `script_output.json` çš„ç›®å½•ï¼‰

## ç”¨æˆ·ä½¿ç”¨æ–¹å¼

```bash
# åŸºæœ¬ç”¨æ³•ï¼ˆä»é¡¹ç›®æ–‡ä»¶å¤¹è¯»å–å¹¶ç”Ÿæˆå›¾ç‰‡ï¼‰
/video-creator:image /path/to/project_folder

# ä»…éªŒè¯å›¾ç‰‡å®Œæ•´æ€§ï¼ˆä¸ç”Ÿæˆæ–°å›¾ç‰‡ï¼‰
/video-creator:image --verify /path/to/project_folder
```

---

## --verify æ¨¡å¼ï¼ˆéªŒè¯å¹¶è‡ªåŠ¨è¡¥å……ï¼‰

å½“ä½¿ç”¨ `--verify` å‚æ•°æ—¶ï¼Œæ‰§è¡Œå›¾ç‰‡å®Œæ•´æ€§æ£€æŸ¥ï¼Œ**å¦‚æœæœ‰ç¼ºå¤±åˆ™è‡ªåŠ¨è¡¥å……ç”Ÿæˆ**ï¼š

**æ‰§è¡Œæ­¥éª¤**ï¼š

### Step 1: è¿è¡ŒéªŒè¯è„šæœ¬

```bash
python ~/.claude/scripts/verify_images.py /path/to/project_folder
```

### Step 2: æ£€æŸ¥éªŒè¯ç»“æœ

- **å¦‚æœæ²¡æœ‰ç¼ºå¤±**ï¼šæ˜¾ç¤º âœ… å®Œæˆä¿¡æ¯ï¼Œä»»åŠ¡ç»“æŸ
- **å¦‚æœæœ‰ç¼ºå¤±**ï¼šç»§ç»­æ‰§è¡Œ Step 3-5

### Step 3: è¯»å– missing_images.json

è„šæœ¬ä¼šè‡ªåŠ¨ç”Ÿæˆ `missing_images.json`ï¼ŒåŒ…å«æ‰€æœ‰ç¼ºå¤±å›¾ç‰‡çš„ä¿¡æ¯ï¼š
- `index`: åœºæ™¯ç´¢å¼•
- `prompt`: åŸå§‹æç¤ºè¯
- `missing_files`: ç¼ºå¤±çš„æ–‡ä»¶åˆ—è¡¨

### Step 4: ä¸ºæ¯ä¸ªç¼ºå¤±æ–‡ä»¶ç”Ÿæˆå•å¼ å›¾ç‰‡ prompt

å¯¹äº `missing_files` ä¸­çš„æ¯ä¸ªæ–‡ä»¶ï¼š

1. **æå–ç”»é£**ï¼šä»åŸå§‹ `prompt` ä¸­æå–ç”»é£æè¿°ï¼ˆå¦‚ "digital drawing, stick figure style, beige background, 16:9 aspect ratio..."ï¼‰

2. **å®šä½å›¾ç‰‡æè¿°**ï¼šæ ¹æ®ç¼ºå¤±æ–‡ä»¶åç¡®å®šæ˜¯ç¬¬å‡ å¼ å›¾ç‰‡
   - `image_012.png` â†’ å•å›¾åœºæ™¯
   - `image_012_03.png` â†’ ç¬¬3å¼ å›¾ç‰‡ï¼Œæ‰¾ "third image shows..."

3. **åˆå¹¶ç”Ÿæˆå•å¼  prompt**ï¼š
   ```
   åŸå§‹: "Generate three images of [ç”»é£]... first image shows X, second shows Y, third shows Z"
   ç¼ºå¤±: image_012_03.png (ç¬¬3å¼ )

   ç”Ÿæˆ: "Generate one image of [ç”»é£]... showing Z"
   ```

### Step 5: ä½¿ç”¨ output_indexes æ‰¹é‡è¡¥å……ç”Ÿæˆ

```json
{
  "prompts": [
    {"prompt": "ä¸º image_005.png ç”Ÿæˆçš„å•å¼  prompt"},
    {"prompt": "ä¸º image_012_03.png ç”Ÿæˆçš„å•å¼  prompt"}
  ],
  "output_dir": "/path/to/project/images",
  "output_indexes": [5, 1203],
  "concurrency": 10,
  "naming_pattern": "sequential",
  "image_format": "png"
}
```

**output_indexes è®¡ç®—è§„åˆ™**ï¼š
- å•å›¾åœºæ™¯ `image_027.png` â†’ `27`
- å¤šå›¾åœºæ™¯ç¬¬Nå¼  `image_012_03.png` â†’ `12 * 100 + 3 = 1203`

### Step 6: å¾ªç¯éªŒè¯ç›´åˆ°å®Œæ•´

```
ğŸ”„ ç¬¬ 1 æ¬¡éªŒè¯: å‘ç° 5 ä¸ªç¼ºå¤±ï¼Œæ­£åœ¨è¡¥å……ç”Ÿæˆ...
   âœ… ç”Ÿæˆå®Œæˆ: 5 å¼ å›¾ç‰‡
ğŸ”„ ç¬¬ 2 æ¬¡éªŒè¯: å‘ç° 1 ä¸ªç¼ºå¤±ï¼Œæ­£åœ¨è¡¥å……ç”Ÿæˆ...
   âœ… ç”Ÿæˆå®Œæˆ: 1 å¼ å›¾ç‰‡
ğŸ”„ ç¬¬ 3 æ¬¡éªŒè¯: å‘ç° 0 ä¸ªç¼ºå¤±
âœ… æ‰€æœ‰å›¾ç‰‡å·²ç”Ÿæˆå®Œæ¯•ï¼
```

**é‡å¤æ‰§è¡Œ Step 1-5ï¼Œç›´åˆ°éªŒè¯é€šè¿‡ï¼ˆæ— ç¼ºå¤±ï¼‰**

---

## é¡¹ç›®æ–‡ä»¶å¤¹ç»“æ„

æ­¤å‘½ä»¤æœŸæœ›ä»¥ä¸‹é¡¹ç›®æ–‡ä»¶å¤¹ç»“æ„ï¼š
```
<project_folder>/
â”œâ”€â”€ script_output.json      # è¾“å…¥ï¼šè„šæœ¬+æç¤ºè¯ï¼ˆæ¥è‡ª /video-creator:scene-and-promptï¼‰
â””â”€â”€ images/                 # è¾“å‡ºï¼šå›¾åƒæ–‡ä»¶å°†ä¿å­˜åˆ°è¿™é‡Œ
    â”œâ”€â”€ image_001.png       # prompt 1 çš„å›¾åƒï¼ˆå¯èƒ½æœ‰å¤šå¼ : image_001_01.png, image_001_02.pngï¼‰
    â”œâ”€â”€ image_002.png
    â””â”€â”€ image_metadata.json # å…ƒæ•°æ®ï¼ˆåŒ…å«å¤šå›¾åƒä¿¡æ¯ï¼‰
```

## æ‰§è¡Œæ­¥éª¤

### Step 1: éªŒè¯é¡¹ç›®æ–‡ä»¶å¤¹å’Œè¯»å–è¾“å…¥

1. éªŒè¯é¡¹ç›®æ–‡ä»¶å¤¹å­˜åœ¨
2. è¯»å– `<project_folder>/script_output.json`
3. éªŒè¯ JSON æ ¼å¼ï¼ˆå¿…é¡»æ˜¯åŒ…å« `prompt` å­—æ®µçš„æ•°ç»„ï¼‰
4. ç¡®ä¿ `<project_folder>/images/` ç›®å½•å­˜åœ¨
5. æ˜¾ç¤ºä»»åŠ¡æ¦‚è§ˆ

**è¾“å‡ºæ ¼å¼ç¤ºä¾‹**ï¼š
```
ğŸ¨ ç”Ÿæˆ AI å›¾åƒ
================================
é¡¹ç›®æ–‡ä»¶å¤¹: /Users/zhenhaohua/projects/toxic_love
è¾“å…¥æ–‡ä»¶: script_output.json
æç¤ºè¯æ€»æ•°: 24
æ¨¡å‹: doubao-seedream-4-0-250828
å°ºå¯¸: 2K (2048x2048)
è¾“å‡ºç›®å½•: images/
å¹¶å‘æ•°: 3

å‡†å¤‡ç”Ÿæˆå›¾åƒ...
```

### Step 2: åˆ†æ‰¹è°ƒç”¨ MCP æ‰¹é‡å›¾åƒç”Ÿæˆå·¥å…·

**é‡è¦è§„åˆ™**ï¼š
1. å¿…é¡»ä½¿ç”¨ç»å¯¹è·¯å¾„ä½œä¸º output_dir
2. **æ¯æ‰¹æœ€å¤š 10 ä¸ªæç¤ºè¯**
3. ä½¿ç”¨ `start_index` å‚æ•°ç¡®ä¿æ–‡ä»¶å‘½åè¿ç»­

#### ğŸ”¢ æ‰¹æ¬¡åˆ’åˆ†

æ ¹æ®æç¤ºè¯æ€»æ•°è‡ªåŠ¨åˆ’åˆ†æ‰¹æ¬¡ï¼ˆæ¯æ‰¹æœ€å¤š 10 ä¸ªï¼‰ï¼š

| æç¤ºè¯æ€»æ•° | æ‰¹æ¬¡æ•° | æ¯æ‰¹æ•°é‡ |
|-----------|-------|---------|
| 1-10 | 1 | å…¨éƒ¨ |
| 11-20 | 2 | 10 + å‰©ä½™ |
| 21-30 | 3 | 10 + 10 + å‰©ä½™ |
| 31-40 | 4 | 10 + 10 + 10 + å‰©ä½™ |
| ... | ... | ... |

#### ğŸ“‹ åˆ†æ‰¹å¤„ç†æµç¨‹

**æƒ…å†µ Aï¼šæç¤ºè¯ â‰¤ 10 ä¸ªï¼ˆå•æ‰¹å¤„ç†ï¼‰**

```json
{
  "json_file": "/Users/zhenhaohua/projects/toxic_love/script_output.json",
  "output_dir": "/Users/zhenhaohua/projects/toxic_love/images",
  "concurrency": 10,
  "naming_pattern": "sequential",
  "image_format": "png",
  "size": "2K",
  "watermark": false
}
```

**æƒ…å†µ Bï¼šæç¤ºè¯ > 10 ä¸ªï¼ˆå¤šæ‰¹å¤„ç†ï¼‰**

å¿…é¡»åˆ†æ‰¹è°ƒç”¨ï¼Œä½¿ç”¨ `prompts` å‚æ•°ä¼ å…¥æ¯æ‰¹çš„æç¤ºè¯æ•°ç»„ï¼Œå¹¶è®¾ç½® `start_index`ï¼š

```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“¦ æ‰¹æ¬¡ 1/5ï¼šå¤„ç†æç¤ºè¯ 1-10
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

**æ‰¹æ¬¡ 1ï¼ˆæç¤ºè¯ 1-10ï¼‰**ï¼š
```json
{
  "prompts": [
    {"prompt": "ç¬¬1ä¸ªæç¤ºè¯...", "script": "ç¬¬1å¥è„šæœ¬..."},
    {"prompt": "ç¬¬2ä¸ªæç¤ºè¯...", "script": "ç¬¬2å¥è„šæœ¬..."},
    ...
    {"prompt": "ç¬¬10ä¸ªæç¤ºè¯...", "script": "ç¬¬10å¥è„šæœ¬..."}
  ],
  "output_dir": "/Users/zhenhaohua/projects/toxic_love/images",
  "start_index": 1,
  "concurrency": 10,
  "naming_pattern": "sequential",
  "image_format": "png",
  "size": "2K",
  "watermark": false
}
```

```
âœ… æ‰¹æ¬¡ 1 å®Œæˆï¼š10/10 æˆåŠŸ
ğŸ“Š ç´¯è®¡è¿›åº¦ï¼š10/45 (22.2%)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“¦ æ‰¹æ¬¡ 2/5ï¼šå¤„ç†æç¤ºè¯ 11-20
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

**æ‰¹æ¬¡ 2ï¼ˆæç¤ºè¯ 11-20ï¼‰**ï¼š
```json
{
  "prompts": [
    {"prompt": "ç¬¬11ä¸ªæç¤ºè¯...", "script": "ç¬¬11å¥è„šæœ¬..."},
    ...
    {"prompt": "ç¬¬20ä¸ªæç¤ºè¯...", "script": "ç¬¬20å¥è„šæœ¬..."}
  ],
  "output_dir": "/Users/zhenhaohua/projects/toxic_love/images",
  "start_index": 11,
  "concurrency": 10,
  "naming_pattern": "sequential",
  "image_format": "png",
  "size": "2K",
  "watermark": false
}
```

**ç»§ç»­å¤„ç†æ‰¹æ¬¡ 3, 4, 5...**

#### âš¡ é‡è¦ï¼šæ‰¹æ¬¡é—´ä¸è¦ç­‰å¾…

- å®Œæˆä¸€æ‰¹åï¼Œ**ç«‹å³å¼€å§‹ä¸‹ä¸€æ‰¹**
- ä¸è¦è¯¢é—®ç”¨æˆ·"æ˜¯å¦ç»§ç»­"
- ä¿æŒè¿ç»­å·¥ä½œç›´åˆ°æ‰€æœ‰æ‰¹æ¬¡å®Œæˆ

#### ğŸ”‘ å…³é”®å‚æ•°è¯´æ˜

| å‚æ•° | è¯´æ˜ |
|------|------|
| `prompts` | å½“å‰æ‰¹æ¬¡çš„æç¤ºè¯æ•°ç»„ï¼ˆæ¯æ‰¹æœ€å¤š 10 ä¸ªï¼‰ |
| `start_index` | æ–‡ä»¶å‘½åèµ·å§‹ç´¢å¼•ï¼Œç¡®ä¿è·¨æ‰¹æ¬¡è¿ç»­ |
| `concurrency` | å¹¶å‘æ•°ï¼Œå›ºå®šä¸º 10ï¼ˆMCP æœ€å¤§æ”¯æŒå€¼ï¼‰ |

### Step 3: æ˜¾ç¤ºæ‰¹é‡å¤„ç†è¿›åº¦

æ¯ä¸ªæ‰¹æ¬¡å®Œæˆåæ˜¾ç¤ºè¿›åº¦ï¼š
```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“¦ æ‰¹æ¬¡ 1/5ï¼šå¤„ç†æç¤ºè¯ 1-10
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â³ å¤„ç†ä¸­ 1/10
âœ… å·²ç”Ÿæˆ: image_001.png (1 å¼ å›¾åƒ)
â³ å¤„ç†ä¸­ 2/10
âœ… å·²ç”Ÿæˆ: image_002_01.png, image_002_02.png, image_002_03.png (3 å¼ å›¾åƒ)
...
âœ… æ‰¹æ¬¡ 1 å®Œæˆï¼š10/10 æˆåŠŸï¼Œç”Ÿæˆ 15 å¼ å›¾åƒ
ğŸ“Š ç´¯è®¡è¿›åº¦ï¼š10/45 æç¤ºè¯ (22.2%)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“¦ æ‰¹æ¬¡ 2/5ï¼šå¤„ç†æç¤ºè¯ 11-20
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â³ å¤„ç†ä¸­ 1/10
âœ… å·²ç”Ÿæˆ: image_011.png (1 å¼ å›¾åƒ)
...
```

**æ³¨æ„**: å½“ `sequential_image_generation` ä¸º `'auto'` æˆ– `'on'` æ—¶ï¼Œæ¨¡å‹ä¼šæ ¹æ® prompt å†…å®¹è‡ªåŠ¨å†³å®šç”Ÿæˆå›¾åƒæ•°é‡ã€‚

### Step 4: éªŒè¯å›¾ç‰‡å®Œæ•´æ€§ï¼ˆå¿…é¡»æ‰§è¡Œï¼‰

**æ‰€æœ‰æ‰¹æ¬¡å®Œæˆåï¼Œå¿…é¡»ä½¿ç”¨éªŒè¯è„šæœ¬æ£€æŸ¥æ˜¯å¦æœ‰é—æ¼çš„å›¾ç‰‡ï¼š**

#### ä½¿ç”¨éªŒè¯è„šæœ¬

```bash
python ~/.claude/scripts/verify_images.py /path/to/project_folder
```

è„šæœ¬ä¼šè‡ªåŠ¨ï¼š
1. è¯»å– `script_output.json`ï¼Œè·å–æ¯ä¸ªæç¤ºè¯çš„ `image_count`
2. æ ¹æ®å‘½åè§„åˆ™æ¨æ–­é¢„æœŸçš„å›¾ç‰‡æ–‡ä»¶å
3. æ‰«æ `images/` ç›®å½•ï¼Œå¯¹æ¯”æ£€æŸ¥
4. è¾“å‡ºç¼ºå¤±çš„å›¾ç‰‡ index å’Œå¯¹åº”çš„ prompt
5. **è‡ªåŠ¨ç”Ÿæˆ `missing_images.json` æ–‡ä»¶**ï¼ˆå¦‚æœ‰ç¼ºå¤±ï¼‰

#### å‘½åè§„åˆ™

- **å•å›¾åƒ** (image_count=1): `image_003.png`ï¼ˆæ— åç¼€ï¼‰
- **å¤šå›¾åƒ** (image_count>1): `image_001_01.png`, `image_001_02.png`, ...

#### å¦‚æœå‘ç°ç¼ºå¤±å›¾ç‰‡

è„šæœ¬ä¼šè¾“å‡ºç¼ºå¤±ä¿¡æ¯å¹¶è‡ªåŠ¨ä¿å­˜ `missing_images.json`ï¼š

```
âš ï¸ ç¼ºå¤±çš„å›¾ç‰‡:

  - Index 15: image_015.png
    Script: "Here's the reality."
    Prompt: "Generate one image of..."

  - Index 44: image_044_02.png, image_044_03.png
    Script: "Stay with me..."
    Prompt: "Generate three images of..."

ç¼ºå¤±æ€»æ•°: 3 å¼ å›¾ç‰‡ (æ¥è‡ª 2 ä¸ªæç¤ºè¯)

ğŸ“„ ç¼ºå¤±ä¿¡æ¯å·²ä¿å­˜åˆ°: /path/to/project/missing_images.json
   å¯ä½¿ç”¨æ­¤æ–‡ä»¶é…åˆ prompt_to_image_batch è¡¥å……ç”Ÿæˆç¼ºå¤±å›¾ç‰‡
```

#### missing_images.json æ–‡ä»¶æ ¼å¼

```json
{
  "generated_at": "2024-01-15T10:30:00",
  "project_folder": "/path/to/project",
  "summary": {
    "expected_count": 45,
    "actual_count": 42,
    "missing_count": 3,
    "missing_prompts_count": 2
  },
  "missing_prompts": [
    {
      "index": 15,
      "prompt": "Generate one image of...",
      "script": "Here's the reality.",
      "expected_count": 1,
      "missing_files": ["image_015.png"],
      "missing_count": 1
    }
  ]
}
```

#### ä½¿ç”¨ missing_images.json è¡¥å……ç”Ÿæˆ

**è¯»å– `missing_images.json`**ï¼Œä¸ºæ¯ä¸ªç¼ºå¤±çš„å›¾ç‰‡ç”Ÿæˆå•å¼ å›¾ç‰‡çš„æç¤ºè¯ï¼Œç„¶åä½¿ç”¨ `prompt_to_image_batch` çš„ `output_indexes` å‚æ•°æ‰¹é‡è¡¥å……ç”Ÿæˆã€‚

##### Step 1: ç”Ÿæˆå•å¼ å›¾ç‰‡æç¤ºè¯

å¯¹äº `missing_images.json` ä¸­çš„æ¯ä¸ªç¼ºå¤±æ–‡ä»¶ï¼Œéœ€è¦ç”Ÿæˆå•å¼ å›¾ç‰‡çš„æç¤ºè¯ï¼š

1. ä» `original_prompt` ä¸­æå–**ç”»é£æè¿°**ï¼ˆå¦‚ "digital drawing, stick figure style, beige background, 16:9 aspect ratio..."ï¼‰
2. æ ¹æ®ç¼ºå¤±æ–‡ä»¶çš„ä½ç½®ï¼ˆå¦‚ `_03` è¡¨ç¤ºç¬¬3å¼ ï¼‰åœ¨åŸ prompt ä¸­æ‰¾åˆ°å¯¹åº”çš„**å›¾ç‰‡æè¿°**ï¼ˆå¦‚ "third image shows Z"ï¼‰
3. åˆå¹¶ç”»é£ + å•å¼ å›¾ç‰‡æè¿°ï¼Œç”Ÿæˆæ–°çš„å•å¼ å›¾ç‰‡ prompt

**ç¤ºä¾‹**ï¼š
```
åŸå§‹ prompt: "Generate three images of digital drawing, stick figure style...
             first image shows X, second image shows Y, third image shows Z..."
ç¼ºå¤±æ–‡ä»¶: image_012_03.pngï¼ˆç¬¬3å¼ ï¼‰

ç”Ÿæˆçš„å•å¼  prompt: "Generate one image of digital drawing, stick figure style...
                   showing Z..."
```

##### Step 2: ä½¿ç”¨ output_indexes æ‰¹é‡ç”Ÿæˆ

ä½¿ç”¨ `prompt_to_image_batch` çš„ `output_indexes` å‚æ•°ï¼Œå¯ä»¥æ‰¹é‡ç”Ÿæˆéè¿ç»­ç´¢å¼•çš„å›¾ç‰‡ï¼š

```json
{
  "prompts": [
    {"prompt": "ç´¢å¼•5çš„å•å¼ å›¾ç‰‡æç¤ºè¯..."},
    {"prompt": "ç´¢å¼•12ç¬¬3å¼ çš„å•å¼ å›¾ç‰‡æç¤ºè¯..."},
    {"prompt": "ç´¢å¼•27çš„å•å¼ å›¾ç‰‡æç¤ºè¯..."}
  ],
  "output_dir": "/path/to/project/images",
  "output_indexes": [5, 1203, 27],
  "concurrency": 10,
  "naming_pattern": "sequential",
  "image_format": "png"
}
```

**output_indexes å‘½åè§„åˆ™**ï¼š
- å•å›¾åœºæ™¯ï¼šç›´æ¥ä½¿ç”¨ indexï¼ˆå¦‚ `27` â†’ `image_027.png`ï¼‰
- å¤šå›¾åœºæ™¯æŸä¸€å¼ ï¼šä½¿ç”¨ `index * 100 + position`ï¼ˆå¦‚ index=12 çš„ç¬¬3å¼  â†’ `1203` â†’ `image_012_03.png`ï¼‰

**æ³¨æ„**ï¼š
- å¿…é¡»ä¸ºæ¯ä¸ªç¼ºå¤±æ–‡ä»¶ç”Ÿæˆç‹¬ç«‹çš„å•å¼ å›¾ç‰‡ prompt
- `output_indexes` æ•°ç»„é•¿åº¦å¿…é¡»ä¸ `prompts` æ•°ç»„é•¿åº¦ä¸€è‡´
- ç”Ÿæˆå•å¼ å›¾ç‰‡ prompt æ—¶ï¼Œéœ€è¦ LLM ç†è§£åŸ prompt ç»“æ„å¹¶æå–å¯¹åº”å†…å®¹

#### å¾ªç¯æ£€æŸ¥ç›´åˆ°å®Œæ•´

```
ğŸ”„ ç¬¬ 1 æ¬¡æ£€æŸ¥: å‘ç° 2 ä¸ªç¼ºå¤±ï¼Œæ­£åœ¨è¡¥å……...
ğŸ”„ ç¬¬ 2 æ¬¡æ£€æŸ¥: å‘ç° 0 ä¸ªç¼ºå¤±
âœ… æ‰€æœ‰å›¾ç‰‡å·²ç”Ÿæˆå®Œæ¯•ï¼
```

**å¿…é¡»å¾ªç¯æ£€æŸ¥ï¼Œç›´åˆ°æ²¡æœ‰ç¼ºå¤±çš„å›¾ç‰‡ä¸ºæ­¢ã€‚**

---

### Step 5: æ˜¾ç¤ºå®Œæˆæ‘˜è¦å’Œåç»­å‘½ä»¤

```
ğŸ‰ å›¾åƒç”Ÿæˆå®Œæˆï¼
================================
ğŸ“ æç¤ºè¯æ€»æ•°: 45
ğŸ“¦ å¤„ç†æ‰¹æ¬¡: 5 æ‰¹ï¼ˆæ¯æ‰¹æœ€å¤š 10 ä¸ªï¼‰
ğŸ–¼ï¸ ç”Ÿæˆå›¾åƒæ€»æ•°: 58 (éƒ¨åˆ† prompt ç”Ÿæˆäº†å¤šå¼ å›¾åƒ)
âœ… æˆåŠŸ: 45/45 ä¸ªæç¤ºè¯
ğŸ”„ è¡¥å……ç”Ÿæˆ: 2 ä¸ªï¼ˆç¬¬ 1 æ¬¡æ£€æŸ¥æ—¶å‘ç°ç¼ºå¤±ï¼‰
ğŸ“‚ è¾“å‡ºç›®å½•: /Users/zhenhaohua/projects/toxic_love/images/
ğŸ’¾ æ€»å¤§å°: 116.5 MB
ğŸ“ å…ƒæ•°æ®: image_metadata.json

åç»­å‘½ä»¤:
  åˆ›å»ºè§†é¢‘: /video-creator:jianying_draft /path/to/project
```

## é»˜è®¤è®¾ç½®è¯´æ˜

- **æ¨¡å‹**: `doubao-seedream-4-0-250828`
- **å°ºå¯¸**: `2K` (2048x2048 åƒç´ )
- **å¹¶å‘æ•°**: `10` (åŒæ—¶å¤„ç† 10 ä¸ªå›¾åƒï¼ŒMCP æ”¯æŒçš„æœ€å¤§å€¼)
- **å‘½åæ¨¡å¼**: `sequential` (image_001.png, image_002.png, ...)
- **å›¾åƒæ ¼å¼**: `png`
- **æ°´å°**: `false` (æ— æ°´å°)

## è¾¹ç•Œæƒ…å†µå¤„ç†

- **é¡¹ç›®æ–‡ä»¶å¤¹ä¸å­˜åœ¨**: æç¤ºå…ˆè¿è¡Œ `/create-youtube-video`
- **script_output.json ä¸å­˜åœ¨**: æç¤ºå…ˆè¿è¡Œ `/create-youtube-video`
- **éƒ¨åˆ†å¤±è´¥**: ç»§ç»­å¤„ç†ï¼Œè®°å½•é”™è¯¯åˆ° metadata
- **æ–‡ä»¶å·²å­˜åœ¨**: è‡ªåŠ¨è·³è¿‡ï¼Œæ”¯æŒæ–­ç‚¹ç»­ä¼ 

## å…ƒæ•°æ®æ–‡ä»¶ç»“æ„

ç”Ÿæˆçš„ `image_metadata.json` æ”¯æŒå¤šå›¾åƒè¾“å‡ºï¼š

```json
{
  "source_file": "/Users/zhenhaohua/projects/toxic_love/script_output.json",
  "generated_at": "2024-01-15T10:30:00Z",
  "total_prompts": 24,
  "total_images": 28,
  "successful_generations": 23,
  "failed_generations": 1,
  "skipped_files": 0,
  "generation_settings": {
    "model": "doubao-seedream-4-0-250828",
    "size": "2K",
    "sequential_image_generation": "auto",
    "watermark": false,
    "image_format": "png"
  },
  "images": [
    {
      "index": 1,
      "prompt": "A person checking phone anxiously...",
      "script": "Your brain on toxic love is like a slot machine player at 3 a.m.",
      "image_count": 1,
      "image_files": [
        {
          "image_file": "image_001.png",
          "absolute_path": "/Users/zhenhaohua/projects/toxic_love/images/image_001.png",
          "image_size_bytes": 2456789
        }
      ]
    },
    {
      "index": 2,
      "prompt": "A sequence showing emotional rollercoaster...",
      "script": "Same reward patterns, same addiction cycles...",
      "image_count": 3,
      "image_files": [
        {
          "image_file": "image_002_01.png",
          "absolute_path": "/Users/zhenhaohua/projects/toxic_love/images/image_002_01.png",
          "image_size_bytes": 2345678
        },
        {
          "image_file": "image_002_02.png",
          "absolute_path": "/Users/zhenhaohua/projects/toxic_love/images/image_002_02.png",
          "image_size_bytes": 2234567
        },
        {
          "image_file": "image_002_03.png",
          "absolute_path": "/Users/zhenhaohua/projects/toxic_love/images/image_002_03.png",
          "image_size_bytes": 2123456
        }
      ]
    }
  ],
  "summary": {
    "total_size_bytes": 55950000,
    "total_size_mb": 55.95,
    "average_size_bytes": 1998214
  },
  "errors": [
    {
      "index": 15,
      "prompt": "Failed prompt text...",
      "error": "API timeout"
    }
  ]
}
```

### å…³é”®å­—æ®µè¯´æ˜

| å­—æ®µ | è¯´æ˜ |
|------|------|
| `total_prompts` | è¾“å…¥çš„ prompt æ€»æ•° |
| `total_images` | å®é™…ç”Ÿæˆçš„å›¾åƒæ€»æ•°ï¼ˆå¯èƒ½å¤§äº prompt æ•°ï¼‰ |
| `image_count` | è¯¥ prompt ç”Ÿæˆçš„å›¾åƒæ•°é‡ |
| `image_files` | å›¾åƒæ–‡ä»¶æ•°ç»„ï¼ˆæ”¯æŒå¤šå›¾åƒï¼‰ |
| `absolute_path` | å›¾åƒæ–‡ä»¶çš„ç»å¯¹è·¯å¾„ |

### å¤šå›¾åƒå‘½åè§„åˆ™

- **å•å›¾åƒ**: `image_001.png`, `image_002.png`, ...
- **å¤šå›¾åƒ**: `image_001_01.png`, `image_001_02.png`, `image_001_03.png`, ...

## æ€§èƒ½è¯´æ˜

- å¹³å‡æ¯ä¸ªå›¾åƒç”Ÿæˆæ—¶é—´: 15-30 ç§’
- 24 ä¸ªå›¾åƒé¢„è®¡è€—æ—¶: 2-4 åˆ†é’Ÿï¼ˆå¹¶å‘å¤„ç†ï¼‰
- æ¯å¼  2K å›¾åƒçº¦ 2-3 MB (PNG æ ¼å¼)

## æˆåŠŸæ ‡å‡†

âœ… ä»»åŠ¡æˆåŠŸçš„æ ‡å¿—ï¼š
1. æˆåŠŸä»é¡¹ç›®æ–‡ä»¶å¤¹è¯»å– `script_output.json`
2. **æ­£ç¡®åˆ’åˆ†æ‰¹æ¬¡**ï¼šæ¯æ‰¹æœ€å¤š 10 ä¸ªæç¤ºè¯
3. **åˆ†æ‰¹è°ƒç”¨** MCP prompt_to_image_batch å·¥å…·ï¼Œä½¿ç”¨æ­£ç¡®çš„ `start_index`
4. ç”Ÿæˆå›¾åƒæ–‡ä»¶åˆ° `<project_folder>/images/` ç›®å½•
5. **éªŒè¯å›¾ç‰‡å®Œæ•´æ€§**ï¼šæ£€æŸ¥æ‰€æœ‰é¢„æœŸå›¾ç‰‡æ˜¯å¦éƒ½å·²ç”Ÿæˆ
6. **è¡¥å……ç”Ÿæˆç¼ºå¤±å›¾ç‰‡**ï¼šå¦‚æœ‰é—æ¼ï¼Œå¿…é¡»è¡¥å……ç”Ÿæˆç›´åˆ°å®Œæ•´
7. åˆ›å»º `image_metadata.json` å…ƒæ•°æ®æ–‡ä»¶ï¼ŒåŒ…å«ï¼š
   - æ¯ä¸ª prompt çš„ `image_count` å’Œ `image_files` æ•°ç»„
   - æ‰€æœ‰å›¾åƒçš„ `absolute_path`
   - `total_images` ç»Ÿè®¡ï¼ˆå¯èƒ½å¤§äº prompt æ•°é‡ï¼‰
8. æ˜¾ç¤ºåç»­å‘½ä»¤æç¤º

## æ³¨æ„äº‹é¡¹

- **ğŸš« æ‰¹æ¬¡å¤§å°é™åˆ¶**ï¼šæ¯æ¬¡è°ƒç”¨æœ€å¤š 10 ä¸ªæç¤ºè¯ï¼Œè¿™æ˜¯ç¡¬æ€§è¦æ±‚
- **ğŸ” å¿…é¡»éªŒè¯å®Œæ•´æ€§**ï¼šæ‰€æœ‰æ‰¹æ¬¡å®Œæˆåï¼Œå¿…é¡»æ£€æŸ¥æ˜¯å¦æœ‰é—æ¼çš„å›¾ç‰‡å¹¶è¡¥å……ç”Ÿæˆ
- **ä½¿ç”¨ç»å¯¹è·¯å¾„**: json_file å’Œ output_dir å¿…é¡»æ˜¯ç»å¯¹è·¯å¾„
- **é¡¹ç›®æ–‡ä»¶å¤¹**: æ‰€æœ‰è¾“å‡ºéƒ½ä¿å­˜åˆ°é¡¹ç›®æ–‡ä»¶å¤¹çš„ `images/` å­ç›®å½•ä¸­
- **æ–­ç‚¹ç»­ä¼ **: å·²å­˜åœ¨çš„å›¾åƒæ–‡ä»¶ä¼šè¢«è‡ªåŠ¨è·³è¿‡
- **start_index è¿ç»­æ€§**: åˆ†æ‰¹å¤„ç†æ—¶ï¼Œç¡®ä¿ start_index æ­£ç¡®é€’å¢ï¼ˆæ‰¹æ¬¡1: 1, æ‰¹æ¬¡2: 11, æ‰¹æ¬¡3: 21...ï¼‰
- **å¹¶å‘æ•°**: å›ºå®šä¸º 10ï¼ˆMCP æ”¯æŒçš„æœ€å¤§å€¼ï¼‰
- **å¤šå›¾åƒå¤„ç†**:
  - å¿…é¡»æ£€æŸ¥ MCP å·¥å…·è¿”å›çš„ `image_count` å­—æ®µ
  - å½“ `image_count > 1` æ—¶ï¼Œä½¿ç”¨ `images` æ•°ç»„è·å–æ‰€æœ‰å›¾åƒè·¯å¾„
  - å…ƒæ•°æ®ä¸­çš„ `total_images` å¯èƒ½å¤§äº `total_prompts`
